<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–°–∏–º—É–ª—è—Ç–æ—Ä –º–∞—à–∏–Ω–∏ –¢—é—Ä—ñ–Ω–≥–∞</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 20px;
      text-align: center;
      background: #f0f4ff;
      color: #222;
    }
    textarea, input[type="text"] {
      width: 80%;
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #888;
      background: #fff;
    }
    #tape span {
      display: inline-block;
      padding: 8px;
      border: 2px solid #555;
      width: 20px;
      cursor: pointer;
      font-weight: bold;
      background-color: #e0eaff;
      margin: 1px;
      transition: all 0.2s ease;
    }
    .head {
      background-color: #ffeb3b;
      border-color: #f57f17;
      box-shadow: 0 0 8px 4px #fbc02d;
      transform: scale(1.2);
      z-index: 1;
    }
    table {
      border-collapse: collapse;
      margin: 10px auto;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #999;
      padding: 6px;
      width: 80px;
      text-align: center;
    }
    .controls {
      margin-top: 10px;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      background: #1976d2;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background: #1565c0;
    }
    .current {
      background-color: #c8e6c9 !important;
    }
  </style>
</head>
<body>

<h1>üåê –°–∏–º—É–ª—è—Ç–æ—Ä –º–∞—à–∏–Ω–∏ –¢—é—Ä—ñ–Ω–≥–∞</h1>

<h3>–£–º–æ–≤–∞ –∑–∞–¥–∞—á—ñ:</h3>
<textarea id="task"></textarea>

<h3>–í—Ö—ñ–¥–Ω–µ —Å–ª–æ–≤–æ:</h3>
<input type="text" id="inputWord" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 101" oninput="updateTapeFromInput()">

<div id="tape"></div>

<h3>–ê–ª—Ñ–∞–≤—ñ—Ç:</h3>
<input type="text" id="alphabet" value="0 1 _" oninput="updateAlphabet()">

<h3>–¢–∞–±–ª–∏—Ü—è –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤:</h3>
<table id="rules">
  <thead>
    <tr>
      <th></th>
      <th>Q1</th>
      <th>Q2</th>
    </tr>
  </thead>
  <tbody id="rulesBody"></tbody>
</table>
<button onclick="addStateColumn()">–î–æ–¥–∞—Ç–∏ —Å—Ç–∞–Ω</button>

<h3>–ö–æ–º–µ–Ω—Ç–∞—Ä:</h3>
<textarea id="comment">
–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—è:
1. –£–≤–µ–¥—ñ—Ç—å —É–º–æ–≤—É –∑–∞–¥–∞—á—ñ —É –≤–µ—Ä—Ö–Ω—å–æ–º—É –ø–æ–ª—ñ.
2. –í–≤–µ–¥—ñ—Ç—å –≤—Ö—ñ–¥–Ω–µ —Å–ª–æ–≤–æ ‚Äî –≤–æ–Ω–æ –∑ º—è–≤–∏—Ç—å—Å—è –Ω–∞ —Å—Ç—Ä—ñ—á—Ü—ñ.
3. –ö–ª–∞—Ü–Ω—ñ—Ç—å –ø–æ –∫–ª—ñ—Ç–∏–Ω—Ü—ñ —Å—Ç—Ä—ñ—á–∫–∏, —â–æ–± –æ–±—Ä–∞—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤—É –ø–æ–∑–∏—Ü—ñ—é –≥–æ–ª–æ–≤–∫–∏.
4. –í –ø–æ–ª—ñ "–ê–ª—Ñ–∞–≤—ñ—Ç" –∑–∞–¥–∞–π—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ñ —Å–∏–º–≤–æ–ª–∏, –ø—Ä–æ–±—ñ–ª ‚Äî —Ü–µ "_".
5. –í —Ç–∞–±–ª–∏—Ü—ñ –∑–∞–¥–∞–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —É —Ñ–æ—Ä–º–∞—Ç—ñ: [–Ω–æ–≤–∏–π_—Å–∏–º–≤–æ–ª] [–Ω–∞–ø—Ä—è–º–æ–∫: > < .] [–Ω–æ–≤–∏–π_—Å—Ç–∞–Ω].
6. –Ø–∫—â–æ —Å–∏–º–≤–æ–ª –∫–æ–º–∞–Ω–¥–∏ ‚Äî "." —ñ —Å—Ç–∞–Ω ‚Äî "0", –º–∞—à–∏–Ω–∞ –∑—É–ø–∏–Ω–∏—Ç—å—Å—è.
7. –Ø–∫—â–æ —Å–∏–º–≤–æ–ª –∫–æ–º–∞–Ω–¥–∏ ‚Äî "." —ñ —Å—Ç–∞–Ω ‚Äî Q1, –º–∞—à–∏–Ω–∞ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–º—ñ–Ω—é—î —ñ –ª–∏—à–µ –æ–≥–ª—è–¥–∞—î –ø–æ—Ç–æ—á–Ω—É –∫–ª—ñ—Ç–∏–Ω–∫—É.
8. "–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫" –≤–∏–∫–æ–Ω—É—î –¥—ñ—é –∑–≥—ñ–¥–Ω–æ –∑ –ø–æ—Ç–æ—á–Ω–∏–º —Å–∏–º–≤–æ–ª–æ–º —Ç–∞ —Å—Ç–∞–Ω–æ–º.
9. "–°–∫–∏–Ω—É—Ç–∏" ‚Äî –æ—á–∏—â–∞—î —Å—Ç—Ä—ñ—á–∫—É —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î —Å—Ç–∞–Ω —É Q1.
</textarea>

<div class="controls">
  <button onclick="startMachine()">–°—Ç–∞—Ä—Ç</button>
  <button onclick="nextStep()">–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫</button>
  <button onclick="resetMachine()">–°–∫–∏–Ω—É—Ç–∏</button>
</div>

<script>
let tape = Array(21).fill('_');
let headPos = 10;
let state = 'Q1';

function renderTape() {
  let html = '';
  for (let i = 0; i < tape.length; i++) {
    html += `<span onclick="setHead(${i})" class="${i === headPos ? 'head' : ''}">${tape[i]}</span>`;
  }
  document.getElementById('tape').innerHTML = html;
}

function setHead(pos) {
  headPos = pos;
  renderTape();
}

function updateTapeFromInput() {
  let input = document.getElementById('inputWord').value.trim();
  tape = Array(21).fill('_');
  for (let i = 0; i < input.length && (10 + i) < tape.length; i++) {
    tape[10 + i] = input[i];
  }
  renderTape();
}

function startMachine() {
  state = 'Q1';
  renderTape();
}

function nextStep() {
  let symbol = tape[headPos];
  let table = document.getElementById('rules');
  let rowIdx = Array.from(table.rows).findIndex(r => r.cells[0]?.innerText === symbol);
  let colIdx = Array.from(table.rows[0].cells).findIndex(c => c.innerText === state);
  if (rowIdx === -1 || colIdx === -1) {
    alert('–ù–µ–º–∞—î –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ü—å–æ–≥–æ —Å—Ç–∞–Ω—É!'); return;
  }
  let cell = table.rows[rowIdx].cells[colIdx];
  let cmd = cell.innerText.trim();
  if (!cmd) { alert('–ù–µ–º–∞—î –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ü—å–æ–≥–æ —Å—Ç–∞–Ω—É!'); return; }

  table.querySelectorAll('td').forEach(td => td.classList.remove('current'));
  cell.classList.add('current');

  let parts = cmd.split(/\s+/);
  if (parts.length !== 3) {
    alert('–ö–æ–º–∞–Ω–¥–∞ –ø–æ–≤–∏–Ω–Ω–∞ —Å–∫–ª–∞–¥–∞—Ç–∏—Å—è –∑ —Ç—Ä—å–æ—Ö —á–∞—Å—Ç–∏–Ω: —Å–∏–º–≤–æ–ª, –Ω–∞–ø—Ä—è–º–æ–∫ (> < .), –Ω–æ–≤–∏–π —Å—Ç–∞–Ω');
    return;
  }

  let [newSymbol, direction, newState] = parts;

  if (newSymbol === '.' && newState === '0') {
    alert('–ú–∞—à–∏–Ω–∞ –∑—É–ø–∏–Ω–∏–ª–∞—Å—å. –ö–æ–º–∞–Ω–¥–∞ . 0 –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞.');
    return;
  }

  if (newSymbol !== '.') tape[headPos] = newSymbol;
  if (direction === '>' || direction === '–≤–ø—Ä–∞–≤–æ') headPos++;
  else if (direction === '<' || direction === '–≤–ª—ñ–≤–æ') headPos--;
  else if (direction !== '.' && newSymbol !== '.') {
    alert('–ù–µ–≤—ñ—Ä–Ω–∏–π –Ω–∞–ø—Ä—è–º–æ–∫. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ >, < –∞–±–æ .');
    return;
  }

  state = newState;
  renderTape();
}

function resetMachine() {
  tape = Array(21).fill('_');
  headPos = 10;
  state = 'Q1';
  document.getElementById('inputWord').value = '';
  renderTape();
}

function updateAlphabet() {
  let alphabet = document.getElementById('alphabet').value.trim().split(' ');
  if (!alphabet.includes('_')) alphabet.push('_');
  let tbody = document.getElementById('rulesBody');
  tbody.innerHTML = '';
  alphabet.forEach(sym => {
    let row = document.createElement('tr');
    let tdSymbol = document.createElement('td');
    tdSymbol.textContent = sym;
    row.appendChild(tdSymbol);
    let states = document.querySelectorAll('#rules thead th');
    for (let i = 1; i < states.length; i++) {
      let td = document.createElement('td');
      td.contentEditable = true;
      td.innerHTML = '';
      row.appendChild(td);
    }
    tbody.appendChild(row);
  });
}

function addStateColumn() {
  let table = document.getElementById('rules');
  let th = document.createElement('th');
  let newState = 'Q' + (table.rows[0].cells.length);
  th.innerText = newState;
  table.rows[0].appendChild(th);
  for (let i = 1; i < table.rows.length; i++) {
    let td = document.createElement('td');
    td.contentEditable = true;
    td.innerHTML = '';
    table.rows[i].appendChild(td);
  }
}

updateAlphabet();
renderTape();
</script>

</body>
</html>